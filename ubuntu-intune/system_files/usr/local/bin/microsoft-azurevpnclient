#!/bin/sh -e

# Container-safe: disable the GPU process sandbox which fails inside nspawn
# (cannot create nested user namespaces). The renderer sandbox stays active.
set -- '--disable-gpu-sandbox' "$@"

if [ -n "$WAYLAND_DISPLAY" ]
then
    unset -v DISPLAY
    set -- \
        '--enable-features=UseOzonePlatform' \
        '--ozone-platform=wayland' \
        "$@"
fi

/opt/microsoft/microsoft-azurevpnclient/microsoft-azurevpnclient "$@"
